package cn.zjiali.robot.test.json

import cn.zjiali.robot.model.response.ServerResponse
import cn.zjiali.robot.model.server.PluginInfo
import cn.zjiali.robot.util.JsonUtil
import cn.zjiali.robot.util.ObjectUtil
import kotlinx.serialization.decodeFromString
import kotlinx.serialization.json.Json
import net.mamoe.mirai.utils.BotConfiguration
import org.junit.Test
import xyz.cssxsh.mirai.tool.FixProtocolVersion

/**
 *
 *
 * @author zJiaLi
 * @since 2022-11-25 18:37
 */
class InnerJsonTest {

    private val json1 = Json { ignoreUnknownKeys = true }

    @Test
    fun testPluginConfigJson() {

        val json: String =
            """{"msg":"æ“ä½œæˆåŠŸ","code":200,"data":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-18 00:49:35","updateBy":"admin","updateTime":"2022-06-18 00:49:35","delFlag":"0","params":{},"id":1,"pluginName":"ä¸€è¨€","pluginCode":"oneSen","pluginDesc":"è·å–ä¼˜ç¾å¥å­","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.SenMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:03:59","updateBy":"admin","updateTime":"2022-06-28 10:03:59","delFlag":"0","params":{},"id":12,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"ä¸€è¨€","inMap":"0","pluginId":1,"pluginCode":"oneSen"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:04:22","updateBy":"admin","updateTime":"2022-06-28 10:04:22","delFlag":"0","params":{},"id":13,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/getSen","inMap":"1","pluginId":1,"pluginCode":"oneSen"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:49:09","updateBy":"admin","updateTime":"2022-11-25 09:49:09","delFlag":"0","params":{},"id":39,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"0","inMap":"0","pluginId":1,"pluginCode":"oneSen"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:53:17","updateBy":"admin","updateTime":"2022-06-26 10:53:17","delFlag":"0","params":{},"id":2,"pluginName":"ç­¾åˆ°","pluginCode":"sign","pluginDesc":"æ¯æ—¥ç­¾åˆ°","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.SignInMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 13:03:03","updateBy":"admin","updateTime":"2022-06-26 13:03:03","delFlag":"0","params":{},"id":7,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"ç­¾åˆ°,ç§¯åˆ†æŸ¥è¯¢","inMap":"0","pluginId":2,"pluginCode":"sign"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 13:03:30","updateBy":"admin","updateTime":"2022-06-26 13:03:30","delFlag":"0","params":{},"id":8,"configName":"ç­¾åˆ°æ¨¡æ¿","configKey":"signTemplate","configValue":"ç­¾åˆ°æˆåŠŸ!\nğŸ’¸è·å¾—ç§¯åˆ†: {getPoints}ç‚¹\nâ­æœ¬æœˆç§¯ç´¯ç­¾åˆ°: {monthDay}å¤©\nğŸ’³å½“å‰ç§¯åˆ†: {points}ç‚¹\nâ­å½“å‰ç­‰çº§: {currentLevel}\nâ­æ¯æ—¥ä¸€å¥: {todayMsg}","inMap":"1","pluginId":2,"pluginCode":"sign"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 13:03:56","updateBy":"admin","updateTime":"2022-06-26 13:03:56","delFlag":"0","params":{},"id":9,"configName":"ç­¾åˆ°æ¥å£åœ°å€","configKey":"signUrl","configValue":"https://robot.zjiali.cn/api/signIn","inMap":"1","pluginId":2,"pluginCode":"sign"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 13:04:25","updateBy":"admin","updateTime":"2022-06-26 13:04:25","delFlag":"0","params":{},"id":10,"configName":"ç§¯åˆ†æŸ¥è¯¢æ¨¡æ¿","configKey":"querySignTemplate","configValue":"ğŸ’¸æ€»ç§¯åˆ†: {points}ç‚¹\nâ­è¿ç»­ç­¾åˆ°: {monthDay}å¤©\nğŸ’³æ€»ç­¾åˆ°å¤©æ•°: {totalDay}å¤©\nâ­å½“å‰ç­‰çº§: {currentLevel}\nâ­æ¯æ—¥ä¸€å¥: {todayMsg}","inMap":"1","pluginId":2,"pluginCode":"sign"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 13:04:44","updateBy":"admin","updateTime":"2022-06-26 13:04:44","delFlag":"0","params":{},"id":11,"configName":"ç§¯åˆ†æŸ¥è¯¢æ¥å£åœ°å€","configKey":"querySignUrl","configValue":"https://robot.zjiali.cn/api/querySignInData","inMap":"1","pluginId":2,"pluginCode":"sign"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:49:38","updateBy":"admin","updateTime":"2022-11-25 09:49:38","delFlag":"0","params":{},"id":40,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"2","inMap":"0","pluginId":2,"pluginCode":"sign"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:54:03","updateBy":"admin","updateTime":"2022-06-26 10:54:03","delFlag":"0","params":{},"id":3,"pluginName":"ä»Šæ—¥è¿åŠ¿","pluginCode":"fortune","pluginDesc":"è·å–æ¯æ—¥è¿åŠ¿","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.FortuneMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:04:50","updateBy":"admin","updateTime":"2022-06-28 10:04:50","delFlag":"0","params":{},"id":14,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"è¿åŠ¿","inMap":"0","pluginId":3,"pluginCode":"fortune"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:05:18","updateBy":"admin","updateTime":"2022-06-28 10:05:18","delFlag":"0","params":{},"id":15,"configName":"è¿åŠ¿æ¨¡æ¿","configKey":"template","configValue":"ğŸŒ“æ‚¨çš„ä»Šæ—¥è¿åŠ¿ä¸º: {fortuneSummary}\nğŸŒŸæ˜ŸæŒ‡æ•°: {luckyStar}\nğŸ“—ç­¾æ–‡: {signText}\nğŸ“è§£ç­¾: {unSignText}","inMap":"0","pluginId":3,"pluginCode":"fortune"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:05:56","updateBy":"admin","updateTime":"2022-06-28 10:05:56","delFlag":"0","params":{},"id":16,"configName":"æ¯æ—¥ä¸€æ¬¡","configKey":"day_one","configValue":"0","inMap":"1","pluginId":3,"pluginCode":"fortune"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:06:15","updateBy":"admin","updateTime":"2022-06-28 10:06:15","delFlag":"0","params":{},"id":17,"configName":"ä½¿ç”¨ç§¯åˆ†","configKey":"point","configValue":"0","inMap":"1","pluginId":3,"pluginCode":"fortune"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:06:31","updateBy":"admin","updateTime":"2022-06-28 10:06:31","delFlag":"0","params":{},"id":18,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/getFortuneOfToday","inMap":"1","pluginId":3,"pluginCode":"fortune"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:50:01","updateBy":"admin","updateTime":"2022-11-25 09:50:01","delFlag":"0","params":{},"id":41,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"1","inMap":"0","pluginId":3,"pluginCode":"fortune"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:55:43","updateBy":"admin","updateTime":"2022-06-26 10:55:43","delFlag":"0","params":{},"id":4,"pluginName":"è€é»„å†","pluginCode":"yellowCalendar","pluginDesc":"ä»Šæ—¥è€é»„å†","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.YellowCalendarMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:35708415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:17:50","updateBy":"admin","updateTime":"2022-06-28 10:17:50","delFlag":"0","params":{},"id":19,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"è€é»„å†","inMap":"0","pluginId":4,"pluginCode":"yellowCalendar"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:18:21","updateBy":"admin","updateTime":"2022-06-28 10:18:21","delFlag":"0","params":{},"id":20,"configName":"æ¶ˆæ¯æ¨¡æ¿","configKey":"template","configValue":"ä»Šæ—¥è€é»„å†:\né˜³å†:{yangli}\né˜´å†:{yinli}\näº”è¡Œ:{wuxing}\nå†²ç…:{chongsha}\nå½­ç¥–ç™¾å¿Œ:{baiji}\nå‰ç¥å®œè¶‹:{jishen}\nå®œ:{yi}\nå‡¶ç¥å®œå¿Œ:{xiongshen}\nå¿Œ:{ji}","inMap":"0","pluginId":4,"pluginCode":"yellowCalendar"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:18:50","updateBy":"admin","updateTime":"2022-06-28 10:18:50","delFlag":"0","params":{},"id":21,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/yellowCalendar","inMap":"1","pluginId":4,"pluginCode":"yellowCalendar"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:51:11","updateBy":"admin","updateTime":"2022-11-25 09:51:11","delFlag":"0","params":{},"id":42,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"1","inMap":"0","pluginId":4,"pluginCode":"yellowCalendar"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:56:10","updateBy":"admin","updateTime":"2022-06-26 10:56:10","delFlag":"0","params":{},"id":5,"pluginName":"ä¸‡å¹´å†","pluginCode":"calendar","pluginDesc":"ä»Šæ—¥ä¸‡å¹´å†","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.CalendarMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:19:26","updateBy":"admin","updateTime":"2022-06-28 10:19:26","delFlag":"0","params":{},"id":22,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"ä¸‡å¹´å†","inMap":"0","pluginId":5,"pluginCode":"calendar"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:20:20","updateBy":"admin","updateTime":"2022-06-28 10:20:20","delFlag":"0","params":{},"id":23,"configName":"æ¶ˆæ¯æ¨¡æ¿","configKey":"template","configValue":"ä»Šæ—¥ä¸‡å¹´å†:\nå‡æ—¥:{holiday}\nå¿Œ:{avoid}\nå±ç›¸:{animalsYear}\nå‡æ—¥æè¿°:{desc}\nå‘¨å‡ :{weekday}\nå®œ:{suit}\nçºªå¹´:{lunarYear}\nå†œå†:{lunar}\nå…·ä½“æ—¥æœŸ:{date}","inMap":"0","pluginId":5,"pluginCode":"calendar"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:20:45","updateBy":"admin","updateTime":"2022-06-28 10:20:45","delFlag":"0","params":{},"id":24,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/perpetualCalendar","inMap":"1","pluginId":5,"pluginCode":"todayHistory"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:51:59","updateBy":"admin","updateTime":"2022-11-25 09:51:59","delFlag":"0","params":{},"id":43,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"1","inMap":"0","pluginId":5,"pluginCode":"calendar"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:56:41","updateBy":"admin","updateTime":"2022-06-26 10:56:41","delFlag":"0","params":{},"id":6,"pluginName":"å†å²ä¸Šçš„ä»Šå¤©","pluginCode":"todayHistory","pluginDesc":"å†å²ä¸Šçš„ä»Šå¤©","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.TodayOfHistoryMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:22:42","updateBy":"admin","updateTime":"2022-06-28 10:22:42","delFlag":"0","params":{},"id":25,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/todayOfHistory","inMap":"1","pluginId":6,"pluginCode":"todayHistory"},{"searchValue":null,"createBy":"admin","createTime":"2022-10-20 10:48:05","updateBy":"admin","updateTime":"2022-10-20 10:48:05","delFlag":"0","params":{},"id":38,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"å†å²ä¸Šçš„ä»Šå¤©","inMap":"0","pluginId":6,"pluginCode":"todayHistory"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:53:12","updateBy":"admin","updateTime":"2022-11-25 09:53:12","delFlag":"0","params":{},"id":45,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"0","inMap":"0","pluginId":6,"pluginCode":"todayHistory"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:57:15","updateBy":"admin","updateTime":"2022-06-26 10:57:15","delFlag":"0","params":{},"id":7,"pluginName":"ç¬‘è¯","pluginCode":"joke","pluginDesc":"è·å–ç¬‘è¯","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.JokeMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:23:59","updateBy":"admin","updateTime":"2022-06-28 10:23:59","delFlag":"0","params":{},"id":26,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"ç¬‘è¯","inMap":"0","pluginId":7,"pluginCode":"joke"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:24:39","updateBy":"admin","updateTime":"2022-06-28 10:24:39","delFlag":"0","params":{},"id":27,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/queryJoke","inMap":"1","pluginId":7,"pluginCode":"joke"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:53:30","updateBy":"admin","updateTime":"2022-11-25 09:53:30","delFlag":"0","params":{},"id":46,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"0","inMap":"0","pluginId":7,"pluginCode":"joke"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:58:01","updateBy":"admin","updateTime":"2022-06-26 10:58:01","delFlag":"0","params":{},"id":8,"pluginName":"çµç­¾","pluginCode":"lq","pluginDesc":"è§‚éŸ³çµç­¾ã€æœˆè€çµç­¾ã€è´¢ç¥çµç­¾","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.SpiritSignMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:26:04","updateBy":"admin","updateTime":"2022-06-28 10:26:04","delFlag":"0","params":{},"id":28,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"è§‚éŸ³çµç­¾,æœˆè€çµç­¾,è´¢ç¥çµç­¾","inMap":"0","pluginId":8,"pluginCode":"lq"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 10:26:44","updateBy":"admin","updateTime":"2022-06-28 10:26:44","delFlag":"0","params":{},"id":29,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/lq/oneSignPerDay","inMap":"1","pluginId":8,"pluginCode":"lq"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:08:59","updateBy":"admin","updateTime":"2022-06-28 11:08:59","delFlag":"0","params":{},"id":30,"configName":"è§‚éŸ³çµç­¾æ¨¡æ¿","configKey":"gyTemplate","configValue":"{title}\nè¯—æ›°:{shi_yue}\nè¯—æ„:{shi_yi}\nè§£æ›°:{jie_yue}\næœ¬ç­¾ç²¾é«“:{bqjs}\nè¯¦æƒ…è¯·ç‚¹å‡»:{viewUrl}","inMap":"1","pluginId":8,"pluginCode":"lq"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:12:31","updateBy":"admin","updateTime":"2022-06-28 11:12:31","delFlag":"0","params":{},"id":31,"configName":"æœˆè€çµç­¾æ¨¡æ¿","configKey":"ylTemplate","configValue":"{title}\nç­¾è¯—:{qian_shi}\nè§£ç­¾:{jie_qian}\nè¯¦æƒ…è¯·ç‚¹å‡»:{viewUrl}","inMap":"1","pluginId":8,"pluginCode":"lq"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:12:55","updateBy":"admin","updateTime":"2022-06-28 11:12:55","delFlag":"0","params":{},"id":32,"configName":"è´¢ç¥çµç­¾æ¨¡æ¿","configKey":"csTemplate","configValue":"{title}\nè¯—æ›°:{shi_yue}\nå‰å‡¶:{ji_xiong}\nè¯¦æƒ…è¯·ç‚¹å‡»:{viewUrl}","inMap":"1","pluginId":8,"pluginCode":"lq"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:53:50","updateBy":"admin","updateTime":"2022-11-25 09:53:50","delFlag":"0","params":{},"id":47,"configName":"çµç­¾","configKey":"templateFlag","configValue":"2","inMap":"0","pluginId":8,"pluginCode":"lq"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:58:52","updateBy":"admin","updateTime":"2022-06-26 10:58:52","delFlag":"0","params":{},"id":9,"pluginName":"ç‚¹æ­Œ","pluginCode":"request_song","pluginDesc":"ç‚¹æ­Œ","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.RequestSongMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:15:04","updateBy":"admin","updateTime":"2022-06-28 11:15:04","delFlag":"0","params":{},"id":33,"configName":"è§¦å‘å‘½ä»¤","configKey":"command","configValue":"ç‚¹æ­Œ","inMap":"0","pluginId":9,"pluginCode":"request_song"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:15:30","updateBy":"admin","updateTime":"2022-06-28 11:15:30","delFlag":"0","params":{},"id":34,"configName":"è¯·æ±‚åœ°å€","configKey":"url","configValue":"https://robot.zjiali.cn/api/song/requestSong","inMap":"1","pluginId":9,"pluginCode":"request_song"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:54:05","updateBy":"admin","updateTime":"2022-11-25 09:54:05","delFlag":"0","params":{},"id":48,"configName":"ç‚¹æ­Œ","configKey":"templateFlag","configValue":"0","inMap":"0","pluginId":9,"pluginCode":"request_song"}]},{"searchValue":null,"createBy":"admin","createTime":"2022-06-26 10:59:37","updateBy":"admin","updateTime":"2022-06-26 10:59:37","delFlag":"0","params":{},"id":10,"pluginName":"èŒ‰è‰èŠå¤©","pluginCode":"MOLI","pluginDesc":"æ™ºèƒ½èŠå¤©","pluginStatus":1,"pluginClass":"cn.zjiali.robot.handler.MoLiMessageEventHandler","pluginAuthor":"zJiaLi","pluginContact":"QQ:357078415","pluginConfigList":[{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:16:21","updateBy":"admin","updateTime":"2022-06-28 11:16:21","delFlag":"0","params":{},"id":35,"configName":"è¿‡æ»¤å…³é”®å­—","configKey":"ignoreKeyWords","configValue":"å¤©æ°”,ip,@qq,@lol,@sfz,@sjh,@cy,ç¬‘è¯,è§‚éŸ³çµç­¾,æœˆè€çµç­¾,è´¢ç¥çˆ·çµç­¾","inMap":"0","pluginId":10,"pluginCode":"MOLI"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:16:56","updateBy":"admin","updateTime":"2022-06-28 11:16:56","delFlag":"0","params":{},"id":36,"configName":"æ˜¯å¦éœ€è¦@è§¦å‘","configKey":"chatGroupAt","configValue":"1","inMap":"1","pluginId":10,"pluginCode":"MOLI"},{"searchValue":null,"createBy":"admin","createTime":"2022-06-28 11:17:30","updateBy":"admin","updateTime":"2022-06-28 11:17:30","delFlag":"0","params":{},"id":37,"configName":"è¯·æ±‚åœ°å€","configKey":"zUrlChat","configValue":"https://robot.zjiali.cn/api/getChatReply","inMap":"1","pluginId":10,"pluginCode":"MOLI"},{"searchValue":null,"createBy":"admin","createTime":"2022-11-25 09:54:28","updateBy":"admin","updateTime":"2022-11-25 09:54:28","delFlag":"0","params":{},"id":49,"configName":"æ¨¡æ¿æ ‡è¯†","configKey":"templateFlag","configValue":"0","inMap":"0","pluginId":10,"pluginCode":"MOLI"}]}]}"""
        val response =
            json1.decodeFromString<ServerResponse<MutableList<PluginInfo>>>(json)
        println(response)

    }

    @Test
    fun testMapJson() {
        val param = HashMap<String, Any>()
        param["robot"] = "357078415"
        val encodeToString = JsonUtil.obj2str(param)
        println(encodeToString)
        println(switchProtocol("4"))
        println(switchProtocol("3"))
        println(switchProtocol("1"))
        println(switchProtocol(""))
        println(switchProtocol("2"))
    }

    private fun switchProtocol(robotProtocol: String): BotConfiguration.MiraiProtocol {
        val protocol: BotConfiguration.MiraiProtocol = if (!ObjectUtil.isNullOrEmpty(robotProtocol)) {
            when (robotProtocol) {
                "1" -> {
                    BotConfiguration.MiraiProtocol.ANDROID_PAD
                }

                "2" -> {
                    BotConfiguration.MiraiProtocol.ANDROID_WATCH
                }

                "3" -> {
                    BotConfiguration.MiraiProtocol.IPAD
                }

                "4" -> {
                    BotConfiguration.MiraiProtocol.MACOS
                }

                else -> {
                    BotConfiguration.MiraiProtocol.ANDROID_PHONE
                }
            }
        } else {
            BotConfiguration.MiraiProtocol.ANDROID_PHONE
        }
        FixProtocolVersion.sync(protocol)
//        FixProtocolVersion.load(protocol)
        println("${protocol}æ˜¯å¦æ”¯æŒQRç™»å½•${protocol.isQRLoginSupported}")
        return protocol
    }
}